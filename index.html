<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Lista de Tarefas</title>
</head>
<body>
    <h1>Minhas aulas</h1>

    <form id="formTarefa">
        <input type="text" id="descricao" placeholder="Digite a tarefa" required>
        <button type="submit">Adicionar</button>
    </form>

    <ul id="listaTarefas"></ul>
<script>
    async function buscaDados(){
        const resposta = await fetch("http://localhost:8000/tarefas")
        const ul = document.getElementById("listarTarefas")
        ul.innerHTML = ""

        if(resposta.status === 200){
            const dados = await resposta.json()
            dados.forEach(tarefa => {
                const li = document.createElement("li")
                li.innerText = tarefa.descricao
                li.style.marginBottom = "8px"

                // Botão de excluir
                const botaoExcluir = document.createElement("button")
                botaoExcluir.innerText = "Excluir"
                botaoExcluir.onclick = async () => {
                    const confirmacao = confirm("Tem certeza que quer excluir?")
                    if(confirmacao){
                        const res = await fetch(`http://localhost:8000/tarefas/${tarefa.id}`, {
                            method: "DELETE"
                        })
                        if(res.status === 200){
                            buscaDados()
                        }else{
                            alert("Erro ao excluir a tarefa")
                        }
                    }
                }

                li.appendChild(document.createTextNode(" ")) // espaço
                li.appendChild(botaoExcluir)
                ul.appendChild(li)
            })
        } else {
            alert("Erro ao buscar tarefas")
        }
    }

    buscaDados()


        carregarTarefas();
    </script>
</body>
</html>